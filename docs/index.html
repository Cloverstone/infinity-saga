
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">
    <!-- <link rel="canonical" href="https://getbootstrap.com/docs/3.3/examples/dashboard/"> -->

    <title>Graphene Chem Simulator</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" type="text/css" href="assets/css/font-awesome.min.css">
    <!-- <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css"> -->
    <!-- <link rel="stylesheet" type="text/css" href="assets/css/demo.css"> -->
    <link rel="stylesheet" type="text/css" href="assets/css/cobler.css">
    <link rel="stylesheet" type="text/css" href="assets/css/builder.css">
    <link rel="stylesheet" type='text/css' href="assets/css/combobox.css">

    <!-- <link rel="stylesheet" type='text/css' href="assets/css/bootstrap-datepicker.min.css"> -->
    <!-- <link rel="stylesheet" type="text/css" href="assets/css/colorpicker.min.css"> -->
    <link rel="stylesheet" type="text/css" href="assets/css/c3.min.css">
    <link rel="stylesheet" type="text/css" href="assets/css/dropzone.css">
    <link rel="stylesheet" type="text/css" href="assets/css/gform.css">
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
  />
    <!-- <link rel="stylesheet" type='text/css' href="//cdnjs.cloudflare.com/ajax/libs/summernote/0.8.8/summernote.css"> -->

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet"> -->

    <!-- Custom styles for this template -->
    <link href="assets/css/dashboard.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<style>

/* .c3-lines {
    display: none;
} */
body{
  padding:0;margin:0;
  /* background: #005a43; */
  /* background-image:radial-gradient(#fff,rgb(228,241,221) 60%); */
  /* background-repeat:no-repeat */
}
.navbar-default .navbar-nav>li>a{color:#ddd}
.navbar-default .navbar-nav>li>a:hover{color:#fff}
/*#home a img,*/
.device{
  opacity:85%
}
/*#home a img:hover,*/.device:hover{
  opacity:95%
}
a{color:#005a43;cursor: pointer;}
a:hover,a:focus{text-decoration:none;color:#005a43;cursor: pointer;}
.chart:empty::before{
  background-image:url("assets/img/skeleton.png");
  background-size: 300px auto;
  background-repeat: no-repeat;
  background-position: center center;
  content:"";
  display:block;
  height:300px;
  opacity: 3%;
}



pre{
  background:none;
  border:none;
  font-weight: bold;
}

/*stones*/
body {
  background: #444;
  background: #a8b1b9;
  perspective: 0px;
  perspective-origin: 50% 50%;
}

.infinity-stone {
  display: inline-block;
  transition: all 0.85s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  position: relative;
  width: 80px;
  height: 200px;
  transform-style: preserve-3d;
  transform-origin: 50% 50%;
  transform: rotateY(-20deg) rotateZ(-5deg);
  -webkit-animation: rotating 5s linear infinite;
  margin-right: 50px;
}

.stone-face {
  background: red;
  height: 80px;
  width: 50px;
  margin-top: 50px;
  position: absolute;
  border-radius: 20px;
  opacity: 0.5;
  box-shadow: inset 0 0 50px 0px red, 0 0 100px 15px red;
  z-index: 99;
}

.stone-face:before,
.stone-face:after {
  content: "";
  width: 0;
  height: 0;
  border-left: 25px solid transparent;
  border-right: 25px solid transparent;
  position: absolute;
  border-radius: 50px;
  opacity: 0.35;
  z-index: 1;
}

.stone-face:before {
  top: 0px;
  border-bottom: 80px solid black;
}

.stone-face:after {
  bottom: 0px;
  border-top: 80px solid black;
}

.stone-face-front {
  transform: translate3d(0, 0, 0px);
}

.stone-face-back {
  transform: rotateY(180deg) translate3d(0, 0, 5px);
}

@-webkit-keyframes rotating {
  0% {
    -webkit-transform: rotateY(-20deg) rotateZ(-3deg);
  }
  50% {
    -webkit-transform: rotateY(20deg) rotateZ(3deg);
  }
  100% {
    -webkit-transform: rotateY(-20deg) rotateZ(-3deg);
  }
}
.stone-green {
  animation-delay: 2s;
}
.stone-green .stone-face {
  background: green;
  box-shadow: inset 0 0 50px 0px green, 0 0 100px 15px green;
}

.stone-orange {
  animation-delay: 1s;
}
.stone-orange .stone-face {
  background: orange;
  box-shadow: inset 0 0 50px 0px orange, 0 0 100px 15px orange;
}

.stone-purple {
  animation-delay: 1.5s;
}
.stone-purple .stone-face {
  background: purple;
  box-shadow: inset 0 0 50px 0px purple, 0 0 100px 15px purple;
}

.stone-yellow .stone-face {
  background: yellow;
  box-shadow: inset 0 0 50px 0px yellow, 0 0 100px 15px yellow;
}

.stone-blue {
  animation-delay: 0.5s;
}
.stone-blue .stone-face {
  background: #5f5fff;
  box-shadow: inset 0 0 50px 0px #5f5fff, 0 0 100px 15px #5f5fff;
}
input{color:#fff}

.wrapper {
  display: grid;
  grid-template-columns:
    1fr
    min(65ch, 100%)
    1fr;
}
.wrapper > * {
  grid-column: 2;
}
.full-bleed {
  width: 100%;
  grid-column: 1 / 4;
}
.column{position:relative}
</style>
  </head>

  <body>




        
      <div>

        
        <main class="wrapper">
          <div class="full-bleed"><!--9 col-sm-offset-3 col-md-10 col-md-offset-2 main-->
            <div id="stones" class="" style="background-color: #333;padding-left:5%;height:157px;overflow: hidden;position:relative;top:-25px"></div>
          </div>
          <!-- <h1>Super 7 Infinity Saga Adventure</h1> -->
          <div  id="form"></div>
        </main>
        
      </div>

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/sortable.js"></script>
<!-- <script type="text/javascript" src="assets/js/bootstrap.min.js"></script> -->
<script type="text/javascript" src="assets/js/lodash.min.js"></script>
<script type="text/javascript" src="assets/js/moment.js"></script>
<script type="text/javascript" src="assets/js/dropzone.js"></script>
<script type="text/javascript" src="assets/js/toastr.min.js"></script>
<script type="text/javascript" src="assets/js/popper.min.js"></script>
<script type="text/javascript" src="assets/js/gform_default.min.js"></script>
<script type="text/javascript" src="assets/js/cleave.min.js"></script>
<script type="text/javascript" src="assets/js/ractive.min.js"></script>
<script type="text/javascript" src="assets/js/lockr.min.js"></script>
<script type="text/javascript" src="assets/js/d3.min.js"></script>
<script type="text/javascript" src="assets/js/c3.min.js"></script>
<script type="text/javascript" src="assets/js/lib.js"></script>




<script type='text/javascript' >
$('body').keydown(function(event) {
  switch(event.keyCode) {
    case 27://escape
      cb.deactivate();
      break;
  }
});


function launchInterval(actions,interval){
  var actions = actions||[];
  var myinterval = setInterval(function(){
    if(actions.length){
      if(typeof actions[0] == "function"){
        actions.shift().call(this)
      }else{actions.shift()}
    }
    if(!actions.length){
      clearInterval(myinterval);
    }
  },interval||1000)
  return myinterval;
}




data = JSON.parse((Lockr.get('data') || null))|| {stones:[
{
  label:"Time",
  color:"green",
},
{
  label:"Soul",
  color:"orange",
},
{
  label:"Reality",
  color:"red",
},
{
  label:"Space",
  color:"blue",
},
{
  label:"Power",
  color:"purple",
},
{
  label:"Mind",
  color:"yellow",
}
],hints:[
{
  hint:`Alexis, Josephene and Parker -
Welcome to the Infinity Saga! Should you 
accept this challenge you will be asked 
to follow clues that lead to treasure! 
You will be required to travel large 
distances over difficult terrain 
- this is not for the faint of heart!

Do you accept?`,
  answer:"YES"
},
{
  hint:`Alone I sit with such a view
for a short time I will provide
yummy food thats just for you
if climbing you have tried

CODEWORD?`,
  answer:"Tesseract",
  stoneIndex:0
},
{
  hint:`FrIghtened Some Look CareFully
  
SOLUTION?`,
  answer:"cliffs",
},
{
  hint:`These cliffs will take you 
  on a dangerous path, watch your step 
  -  you have been here once before!

CODEWORD?`,
  answer:"Heart",
  stoneIndex:1
},
{
  hint:`Be careful what you touch 
As you set off with a friend 
But don’t let that be a crutch
As you try to change the future
In a place the mind can bend, 
With a wild changing nature.

CODEWORD?`,
  answer:"Aether",
  stoneIndex:2
},
{
  hint:`Over the river and through the wood
On an adventure through the land
Don’t get caught, though you could
And be careful of the quicksand

CODEWORD?`,
  answer:"Necklace",
  stoneIndex:3
},
{
  hint:`Look the ground is moving!
Don't be afraid to cross 
watch your step on stone ground
or all could be for loss

CODEWORD?`,
  answer:"Orb",
  stoneIndex:4
},
{
  hint:`Tmcdq sgd aqhcfd
  
SOLUTION?`,
  answer:"Under the bridge",
},
{
  hint:`Under this bridge you will find words,
   stones, and sometimes a hitchhicking seed.

CODEWORD?`,
  answer:"Sceptor",
  stoneIndex:5
},
{
  hint:`Congratulations on completing the 
  Infinty Saga Challenge!`,
  answer:"Smallcomb"
}
]
}
// data.hints=[
// {
//   hint:`Alone I sit with such a view
// for a short time I will provide
// yummy food thats just for you
// if climbing you have tried

// CODEWORD?`,
//   answer:"Tesseract",
//   stoneIndex:0
// },
// {
//   hint:`FrIghtened Some Look CareFully
  
// SOLUTION?`,
//   answer:"cliffs",
// },
// {
//   hint:"CODEWORD?",
//   answer:"Heart",
//   stoneIndex:1
// },
// {
//   hint:`Be careful what you touch 
// As you set off with a friend 
// But don’t let that be a crutch
// As you try to change the future
// In a place the mind can bend, 
// With a wild changing nature.

// CODEWORD?`,
//   answer:"Aether",
//   stoneIndex:2
// },
// {
//   hint:`Over the river and through the wood
// On an adventure through the land
// Don’t get caught, though you could
// And be careful of the quicksand

// CODEWORD?`,
//   answer:"Necklace",
//   stoneIndex:3
// },
// {
//   hint:`Look the ground is moving!
// Don't be afraid to cross 
// watch your step on stone ground
// or all could be for loss

// CODEWORD?`,
//   answer:"Orb",
//   stoneIndex:4
// },
// {
//   hint:`Tmcdq sgd aqhcfd
  
// SOLUTION?`,
//   answer:"Under the bridge",
// },
// {
//   hint:`Under this bridge you will find words, stones, and sometimes a hitchhicking seed.

// CODEWORD?`,
//   answer:"Sceptor",
//   stoneIndex:5
// }
// ]
  _.each(data.stones,function(stone){
    _.each(['active','working','solved'],function(key){
      stone['_'+key] = stone.active||false
      Object.defineProperty(stone, key,{
        get: function(){
          return stone['_'+key];
        },
        set: function(newState){
          stone['_'+key] = (newState==true);
          Lockr.set('data', JSON.stringify(data, undefined, "\t"));
          ractive.update(data)
          myForm.set({stones:data.stones})
        },enumerable: true,
        configurable: true
      });
    })
  })
const myForm = new gform({
  data:data,
  actions:[],
  fields:[
  {name:"dates",placeholder:"#",label:false,type:"text",array:{min:3,max:3},forceRow:true,validate:[{type:'matches',value:["03/05/09","02/04/11","03/02/13"],message:'<span style="display:none"></span>'},{type:"unique",message:"Answer already used"}],success:'<span class="fa fa-check fa-lg" style="position: absolute;top: -28px;right: 12px;"></span>',satisfied:function(e){
      return this.value.length == 8;
    },show:[{type:"test",name:"/dated",test:function(e){return !e.owner.find({path:'/dated'}).value}
    }]},

    {name:"hints",type:"fieldset",label:false,array:{min:10,max:10},success:'',satisfied:function(e){
      return true;
    },parse:true,show:[{type:"test",name:"active",test:function(e){
      debugger;
      return (e.owner.find('dated').value == true && _.countBy(e.owner.filter('hints'),function(e){return e.value.answer.toLowerCase() == e.value.guess.toLowerCase()})['false']+e.index == 10 );
      // return (e.value.stoneIndex == "" && e.value.answer == e.value.guess) || (e.owner.find('dated').value == true && _.countBy(e.owner.filter('active'),function(e){return e.value})['false'] +e.index == 6) && !e.owner.find({path:'/stones.'+e.index+'.active'}
    // ).value
    }
    }],fields:[{name:"hint",type:"output",label:false,format:{value:"<pre>{{value}}</pre>"}},{name:"answer",type:'hidden'},{name:"stoneIndex",type:"hidden"},{name:"guess",label:"",type:"text",validate:[{type:'custom',test:function(e){
      return !(e.field.parent.initialValue.answer.toLowerCase() == e.field.get().toLowerCase());
    },message:'<span style="display:none"></span>'}] }]},

    {name:"stones",label:false,show:false,parse:true,type:"fieldset",array:{min:6,max:6},fields:[{name:'label',type:'hidden'},{name:'color',type:'hidden'},{name:'active',label:"{{parent.initialValue.label}}",type:"checkbox"}]},
    {name:"dated",type:"checkbox",show:false,parse:true},

  ],
  events:[{
    event:"initialized",
    handler:function(){
      _.each(this.filter('dates'),function(field){
        field.cleave = new Cleave(field.el.querySelector('input'), {
            date: true,
            delimiter: '/',
            datePattern: ['m', 'd','y']
        });
      })
    }
  }
  ]
},"#form").on('valid',function(e){
}).on('input:active', function(e){
  data = _.extend(data,e.form.get())
    Lockr.set('data', JSON.stringify(data, undefined, "\t"));
    ractive.update(data)
}).on('input:dated', function(e){
  data = _.extend(data,e.form.get())
    Lockr.set('data', JSON.stringify(data, undefined, "\t"));
}).on('input:dates', function(e){
  e.form.validate()
  var complete = gform.instances.f0.find({name:"dates",valid:true,isSatisfied:true,editable:true})
  if(complete){
    gform.types.text.edit.call(complete,false)
    var next = gform.instances.f0.find({name:"dates",isSatisfied:false})||gform.instances.f0.find({name:"dates",isSatisfied:true,valid:false})
    if(next){
      next.focus()
    }else{
      // _.find(data.stones,{label:"Space"}).active = true;
      e.form.find('dated').set(true)
      e.form.trigger('change:active')
      // _.find(data.stones,{label:"Space"}).active = true;
      // _.find(data.stones,{label:"Space"}).active = false;

    data = _.extend(data,e.form.get())
    Lockr.set('data', JSON.stringify(data, undefined, "\t"));
    ractive.update(data)
    }
  }
}).on('input:guess', function(e){
  // gform.validateItem.call(e.form,true,e.field)
  e.form.validate()
  if(e.field.parent.get('stoneIndex') !== ''){
    e.form.filter('active')[parseInt(e.field.parent.get('stoneIndex'))].set(e.field.valid)
  }else{
    e.form.trigger('change:active')
  }
  data = _.extend(data,e.form.get())
    Lockr.set('data', JSON.stringify(data, undefined, "\t"));
    ractive.update(data)
  // return e.form.validate()
  // var complete = gform.instances.f0.find({name:"dates",valid:true,isSatisfied:true,editable:true})
  // if(complete){
  //   gform.types.text.edit.call(complete,false)
  //   var next = gform.instances.f0.find({name:"dates",isSatisfied:false})||gform.instances.f0.find({name:"dates",isSatisfied:true,valid:false})
  //   if(next){
  //     next.focus()
  //   }else{
  //     _.find(data.stones,{label:"Space"}).active = true;
  //   }
  // }
}).on('input:hint', function(e){

})



Object.defineProperty(data, 'dates',{
  get: function(){
    myForm.get()['dates']
  },
  set: function(value){

    myForm.set({dates:value})
    Lockr.set('data', JSON.stringify(data, undefined, "\t"));
    ractive.update(data)
  },enumerable: true,configurable: true
});

 var template = `{{#stones}}<div id="{{label}}" class="{{#active}}animate__animated animate__fadeInUp{{/active}}{{^active}}animate__animated animate__fadeOutUp{{/active}}"  style="width:15%;display:inline-block;{{^active}}visibility: hidden{{/active}}">

          <div class="infinity-stone stone-{{color}} ">
            <div class="stone-face stone-face-front"></div>
            <div class="stone-face stone-face-back"></div>
          </div>
        </div>{{/stones}}`

        var ractive = Ractive({
  target: "#stones",
  template: template,
  data: data
});

</script>

  </body>
</html>
